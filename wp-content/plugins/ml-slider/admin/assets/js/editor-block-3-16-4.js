!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=1)}([function(e,t){!function(){e.exports=this.wp.blockEditor}()},function(e,t,r){e.exports=r(2)},function(e,t,r){"use strict";r.r(t);var n=React.createElement("svg",{key:"ms-icon",version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"20px",height:"20px",viewBox:"0 0 20 20",className:"dashicon metaslider-icon"},React.createElement("path",{key:"icon-path",d:"M10,0C4.477,0,0,4.477,0,10s4.477,10,10,10s10-4.477,10-10S15.523,0,10,0z M2.95,12.667l5.796-7.218 l0.979,1.049l-4.817,6.169H2.95z M12.735,12.667l-2.5-3.015l0.959-1.25l3.46,4.265H12.735z M15.013,12.667l-3.838-4.915 l-3.838,4.915H5.378l5.777-7.382l5.895,7.382H15.013z"}));function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?a(e):t}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=window.wp,p=window.React,h=u.components,m=h.Placeholder,f=h.Spinner,w=u.i18n.__,v=u.apiRequest,g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(g,e);var t,r,i,u,h=(t=g,function(){var e,r=d(t);if(c()){var n=d(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return l(this,e)});function g(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),(t=h.call(this,e)).state={height:200,previewIsLoading:!0,slideshowId:null,html:"",previewErrorMessage:""},t.handleOnLoad=t.handleOnLoad.bind(a(t)),t.setHeight=t.setHeight.bind(a(t)),t.getPreview=t.getPreview.bind(a(t)),t.handleResize=t.handleResize.bind(a(t)),t.iframe=p.createRef(),t}return r=g,(i=[{key:"componentDidMount",value:function(){this.getPreview(),window.addEventListener("resize",this.handleResize),this.props.componentDidMount&&this.props.componentDidMount(this)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),this.props.componentWillUnmount&&this.props.componentWillUnmount()}},{key:"componentDidUpdate",value:function(e){this.props.slideshowId===e.slideshowId&&this.props.refresh===e.refresh||(this.setHeight(200),this.getPreview(),this.iframe.current.contentDocument.location.reload(!0))}},{key:"handleOnLoad",value:function(e){var t=this;this.state.html&&(this.iframe.current.contentDocument.editor_block=this,setTimeout((function(){clearInterval(t.loadInterval),t.setHeight(t.iframe.current.contentDocument.body.clientHeight)}),50),this.setState({previewIsLoading:!1}))}},{key:"handleResize",value:function(e){this.setHeight(this.iframe.current.contentDocument.body.clientHeight)}},{key:"setHeight",value:function(e){this.setState({height:e>200?e:200})}},{key:"getPreview",value:function(){var e=this;try{this.setState({html:"",previewIsLoading:!0,previewErrorMessage:""}),v({path:"/metaslider/v1/slideshow/preview",data:{action:"ms_get_preview",slideshow_id:this.props.slideshowId,override_preview_style:!0}}).then((function(t){e.setState({html:t.data}),e.setHeight(e.iframe.current.contentDocument.body.clientHeight)})).fail((function(t){410===t.status?(e.setState({previewIsLoading:!1,previewErrorMessage:t.responseJSON.data.message}),console.error("MetaSlider (Gutenberg): Slideshow not found:",t)):console.error("MetaSlider (Gutenberg): Could not load the preview:",t)}))}catch(e){console.error("MetaSlider (Gutenberg): A general error occured:",e)}}},{key:"render",value:function(){return p.createElement("div",{className:this.props.className+(this.state.previewIsLoading?"":" loading")+" ms-preview"},p.createElement("iframe",{key:"preview-iframe",height:this.state.height,srcDoc:this.state.html||"",onLoad:this.handleOnLoad,ref:this.iframe}),p.createElement("div",{key:"trigger",className:"ms-preview__trigger"}),this.state.previewIsLoading&&p.createElement(m,{key:"ms-loader",className:"ms-loader",label:[n," MetaSlider"]},p.createElement(f,null)," ",w("Loading slideshow","ml-slider")),this.state.previewErrorMessage&&p.createElement(m,{key:"ms-preview-empty",className:"ms-loader",label:[n," MetaSlider"]},this.state.previewErrorMessage))}}])&&o(r.prototype,i),u&&o(r,u),g}(p.Component);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var S=window.wp,E=S.i18n.__,R=S.components.Toolbar,_={normal:{icon:"align-center",title:E("Normal width","ml-slider")},wide:{icon:"align-wide",title:E("Wide width","ml-slider")},full:{icon:"align-full-width",title:E("Full width","ml-slider")}},O=["normal","wide","full"];function k(e){var t=e.value,r=e.onChange,n=e.controls;var i=void 0===n?O:n;return React.createElement(R,{controls:i.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},_[e],{isActive:t===e,onClick:(n=e,function(){return r(t===n?void 0:n)})});var n}))})}var P=window.wp,C=P.i18n.__,M=P.components.SelectControl;function j(e){var t=e.props,r=t.attributes.slideshowId,n=t.slideshows;return React.createElement(M,{label:C("Select a slideshow","ml-slider"),value:r,options:[{label:"-- "+C("Select a slideshow","ml-slider")+" --",value:0}].concat(n.items.map((function(e){return{key:e.id,label:P.htmlEntities.decodeEntities(e.title)+" (#"+e.id+")",value:e.id}}))),onChange:function(e){e=parseInt(e),t.setAttributes({slideshowId:e})}})}var I=window.wp,L=I.i18n.__,x=I.components.Toolbar;function D(e){e.value,e.onChange;var t=e.onClick;return React.createElement(x,{controls:[{icon:"update",title:L("Update preview","ml-slider"),isActive:!1,onClick:t}]})}var N=r(0),H=window.wp,z=H.i18n.__,T=H.element.Fragment,A=H.data.withSelect,W=H.components,U=W.TextControl,B=W.Placeholder,q=W.Spinner,F=W.PanelBody,G=W.BaseControl,J=window.metaslider_block_config||{},K=A((function(e){return{wideControlsEnabled:e("core/editor").getEditorSettings().alignWide}}))((function(e){var t=e.slideshows,r=e.className,i=e.isSelected,o=e.wideControlsEnabled,s=void 0!==o&&o,l=e.attributes.slideshowId,a=e.attributes.stretch,c=e.attributes.containerClass,d=t.isLoading,u=t.items.length||!1,p=e.attributes.refreshPreview,h=i&&React.createElement(T,{key:"inspectorControls"},React.createElement(N.InspectorControls,{key:"inspector"},React.createElement(F,{title:z("Slideshow settings","ml-slider")},u&&React.createElement(j,{props:e}),0!==l&&React.createElement("a",{href:J.plugin_page+"&id="+l,target:"_blank",className:"ms-edit-current-slideshow"},z("Edit slideshow","ml-slider")),s&&React.createElement(G,{label:z("Slideshow width","ml-slider")},React.createElement(k,{value:a,onChange:function(t){setTimeout((function(){window.dispatchEvent(new Event("resize"))}),50),e.setAttributes({stretch:t})}})))),React.createElement(N.InspectorAdvancedControls,null,React.createElement(G,{label:z("Additional CSS Class","ml-slider")},React.createElement(U,{value:c,onChange:function(t){e.setAttributes({containerClass:t})}}))),React.createElement(N.BlockControls,{key:"controls"},s&&React.createElement(k,{label:z("Slideshow width","ml-slider"),value:a,onChange:function(t){setTimeout((function(){window.dispatchEvent(new Event("resize"))}),50),e.setAttributes({stretch:t})}}),0!==l&&React.createElement(D,{key:"refresh",label:z("Refresh preview","ml-slider"),onClick:function(){e.setAttributes({refreshPreview:!p})}})));return u||l||!d?u||l||d?[h,!!l&&React.createElement(g,{key:"preview",className:r,src:J.preview_url+"&slideshow_id="+l,slideshowId:l,isSelected:i,refresh:p}),!l&&React.createElement(B,{key:"instructions",className:e.className,label:[n," MetaSlider"]},React.createElement(j,{key:"slidehow-selector",props:e}))]:React.createElement(B,{className:r,label:[n," MetaSlider"]},z("No slideshows found.","ml-slider")," ",React.createElement("a",{target:"_blank",href:J.plugin_page},z("Create one now!","ml-slider"))):React.createElement(B,{className:r,label:[n," MetaSlider"]},React.createElement(q,{key:"spinner"})," ",z("Loading slideshows list...","ml-slider"))})),Q=window.wp.element.Fragment,V=function(e){var t=e.attributes,r=t.slideshowId,n=t.stretch,i=t.containerClass,o=n?"align"+n:"";return!!r&&React.createElement(Q,null,React.createElement("div",{class:o},"[metaslider id=",r,' cssclass="',i,'"]'))||""},X=window.wp,Y=X.i18n.__,Z=X.blocks.registerBlockType,$=X.data,ee=$.registerStore,te=$.dispatch,re=$.withSelect,ne=X.apiRequest,ie={items:[],isLoading:!0};ee("metaslider",{reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SLIDESHOWS":return{items:t.items,isLoading:!1}}return e},actions:{setSlideshows:function(e){return{type:"SET_SLIDESHOWS",items:e}}},selectors:{getSlideshows:function(e){return e}},resolvers:{getSlideshows:function(e,t){try{ne({path:"/metaslider/v1/slideshow/list"}).then((function(e){!0===e.success?te("metaslider").setSlideshows(e.data):(console.warn("MetaSlider: API Request error:",e.data.message),te("metaslider").setSlideshows([]))}))}catch(e){console.warn("MetaSlider: API Request error:",e),te("metaslider").setSlideshows([])}}}}),Z("metaslider/slider",{title:"MetaSlider",description:Y("Use MetaSlider to insert slideshows and sliders in your page","ml-slider"),icon:n,category:"common",keywords:[Y("slider","ml-slider"),Y("slideshow","ml-slider"),Y("gallery","ml-slider")],attributes:{slideshowId:{type:"number",default:0},stretch:{type:"string",default:"normal"},containerClass:{type:"string",default:""}},supports:{customClassName:!1},edit:re((function(e,t){return{slideshows:(0,e("metaslider").getSlideshows)()}}))(K),save:function(e){return V(e)},getEditWrapperProps:function(e){var t=e.stretch;if(-1!==["wide","full","normal"].indexOf(t))return{"data-align":t}}})}]);